# Pocket Signals - Admin Panel

Простий HTML/JS інтерфейс для управління системою розсилки.

## Функції

✅ **Dashboard** - Загальна статистика в реальному часі
✅ **Ланцюжки** - Створення та управління ланцюжками повідомлень
✅ **Користувачі** - Перегляд всіх користувачів з постбеків
✅ **Telegram акаунти** - Додавання та управління акаунтами
✅ **Логи** - Моніторинг відправлених повідомлень

## Запуск

### Варіант 1: Просто відкрити файл
Просто відкрий `index.html` в браузері - воно працюватиме!

### Варіант 2: Через локальний сервер (рекомендовано)

**Python:**
```bash
cd admin-panel
python -m http.server 8080
```

**Node.js:**
```bash
cd admin-panel
npx http-server -p 8080
```

Потім відкрий: http://localhost:8080

## Налаштування

В файлі `app.js` змінити API_URL якщо потрібно:

```javascript
const API_URL = 'http://localhost:3000/api';
```

## Використання

### 1. Dashboard
Показує загальну статистику:
- Кількість користувачів
- Відправлені повідомлення
- Активні ланцюжки

### 2. Створення ланцюжка
1. Натисни "Створити ланцюжок"
2. Введи назву
3. Обери подію-тригер
4. Додай кроки:
   - Затримка (години)
   - Тип (текст/зображення)
   - Контент
5. Натисни "Створити"

**Приклад:**
- **Назва**: Вітальний ланцюжок
- **Подія**: Реєстрація
- **Крок 1**: Відразу (0 год) - "Привіт! Дякую за реєстрацію!"
- **Крок 2**: Через 1 годину - "Ось інструкція..."
- **Крок 3**: Через 24 години - "Нагадування!"

### 3. Додавання Telegram акаунта
1. Натисни "Додати акаунт"
2. Введи дані:
   - Номер телефону (+380...)
   - API ID (з my.telegram.org)
   - API Hash (з my.telegram.org)
3. Натисни "Додати"
4. **ВАЖЛИВО**: Запусти `npm run auth` в telegram-bot для авторизації

### 4. Перегляд користувачів
- Всі користувачі з постбеків
- Фільтрація та пошук
- Статистика по кожному

### 5. Логи
- Всі відправлені повідомлення
- Статуси відправки
- Помилки (якщо є)

## Типи повідомлень

### Текст
Просте текстове повідомлення

### Зображення
Тільки зображення (потрібен URL)

### Текст + Зображення
Зображення з підписом

## Події (тригери)

- **registration** - Реєстрація користувача
- **email_confirmed** - Email підтверджено
- **ftd** - Перший депозит
- **repeat_deposit** - Повторний депозит
- **commission** - Комісія нарахована
- **withdrawal** - Вивід коштів

## Затримка між кроками

Кожен крок може мати затримку:
- `0` год - відправити відразу після події
- `1` год - через 1 годину
- `24` год - через 24 години (1 день)
- `168` год - через тиждень

## Поради

1. **Почни з простого** - створи ланцюжок з 1-2 кроками для тестування
2. **Тестуй на собі** - використай свій Telegram ID в `sub_id1`
3. **Слідкуй за логами** - перевіряй чи відправляються повідомлення
4. **Додай кілька акаунтів** - для розподілу навантаження

## Troubleshooting

### API Offline
- Перевір чи запущений backend (`npm start` в папці backend)
- Перевір URL в `app.js`

### Ланцюжок не спрацьовує
- Перевір чи є активні Telegram акаунти
- Перевір логи в telegram-bot
- Перевір чергу: `SELECT * FROM message_queue WHERE status = 'pending'`

### Повідомлення не відправляються
- Перевір чи запущений telegram-bot
- Перевір чи є `telegram_id` у користувача
- Перевір чи авторизовані Telegram акаунти

## API Endpoints

Всі доступні endpoints:

```
GET  /api/stats/overview        - Загальна статистика
GET  /api/chains                - Всі ланцюжки
POST /api/chains                - Створити ланцюжок
GET  /api/chains/:id            - Один ланцюжок
PUT  /api/chains/:id            - Оновити ланцюжок
DELETE /api/chains/:id          - Видалити ланцюжок
GET  /api/users                 - Всі користувачі
GET  /api/accounts              - Всі акаунти
POST /api/accounts              - Додати акаунт
GET  /api/logs                  - Логи повідомлень
```
