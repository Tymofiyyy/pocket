-- –ü—Ä–∏–∫–ª–∞–¥ 1: –õ–∞–Ω—Ü—é–∂–æ–∫ –¥–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó
-- 3 –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: –≤—ñ–¥—Ä–∞–∑—É, —á–µ—Ä–µ–∑ 1 –≥–æ–¥–∏–Ω—É, —á–µ—Ä–µ–∑ 24 –≥–æ–¥–∏–Ω–∏

-- –°—Ç–≤–æ—Ä—é—î–º–æ –ª–∞–Ω—Ü—é–∂–æ–∫
INSERT INTO message_chains (name, trigger_event, is_active)
VALUES ('–í—ñ—Ç–∞–ª—å–Ω–∏–π –ª–∞–Ω—Ü—é–∂–æ–∫ –ø—ñ—Å–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó', 'registration', true)
RETURNING id;

-- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π ID –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–∞–ø–∏—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 1)
-- –ó–∞–º—ñ—Å—Ç—å 1 –ø—ñ–¥—Å—Ç–∞–≤–ª—è–π —Å–≤—ñ–π ID!

-- –ö—Ä–æ–∫ 1: –ü—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è (–≤—ñ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó)
INSERT INTO chain_steps (chain_id, step_order, delay_hours, message_type, message_text)
VALUES (
  1,  -- —Ç—É—Ç ID –ª–∞–Ω—Ü—é–∂–∫–∞
  1,  -- –ø–æ—Ä—è–¥–æ–∫ –∫—Ä–æ–∫—É
  0,  -- –∑–∞—Ç—Ä–∏–º–∫–∞ 0 –≥–æ–¥–∏–Ω (–≤—ñ–¥—Ä–∞–∑—É)
  'text',
  '–í—ñ—Ç–∞—é! üëã

–î—è–∫—É—é –∑–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é –Ω–∞ Pocket Partners!

–¢–∏ —Ç—ñ–ª—å–∫–∏ —â–æ –∑—Ä–æ–±–∏–≤ –ø–µ—Ä—à–∏–π –∫—Ä–æ–∫ –¥–æ –∑–∞—Ä–æ–±—ñ—Ç–∫—É –Ω–∞ —Ç—Ä–µ–π–¥–∏–Ω–≥—É. –ó–∞—Ä–∞–∑ —è —Ä–æ–∑–ø–æ–≤—ñ–º —è–∫ –≤—Å–µ –ø—Ä–∞—Ü—é—î...'
);

-- –ö—Ä–æ–∫ 2: –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è (—á–µ—Ä–µ–∑ 1 –≥–æ–¥–∏–Ω—É)
INSERT INTO chain_steps (chain_id, step_order, delay_hours, message_type, message_text)
VALUES (
  1,
  2,
  1,  -- —á–µ—Ä–µ–∑ 1 –≥–æ–¥–∏–Ω—É
  'text',
  'üìä –Ø–∫ –ø–æ—á–∞—Ç–∏ –∑–∞—Ä–æ–±–ª—è—Ç–∏?

1Ô∏è‚É£ –ü–æ–ø–æ–≤–Ω–∏ —Å–≤—ñ–π —Ä–∞—Ö—É–Ω–æ–∫ (–º—ñ–Ω—ñ–º—É–º $10)
2Ô∏è‚É£ –û–±–µ—Ä–∏ –∞–∫—Ç–∏–≤ –¥–ª—è —Ç–æ—Ä–≥—ñ–≤–ª—ñ
3Ô∏è‚É£ –ó—Ä–æ–±–∏ —Å–≤–æ—é –ø–µ—Ä—à—É —É–≥–æ–¥—É

üí∞ –ó–∞ –ø–µ—Ä—à–∏–π –¥–µ–ø–æ–∑–∏—Ç —Ç–∏ –æ—Ç—Ä–∏–º–∞—î—à –±–æ–Ω—É—Å –¥–æ 100%!'
);

-- –ö—Ä–æ–∫ 3: –ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è (—á–µ—Ä–µ–∑ 24 –≥–æ–¥–∏–Ω–∏)
INSERT INTO chain_steps (chain_id, step_order, delay_hours, message_type, message_text)
VALUES (
  1,
  3,
  24,  -- —á–µ—Ä–µ–∑ 24 –≥–æ–¥–∏–Ω–∏
  'text',
  '‚è∞ –ü—Ä–∏–≤—ñ—Ç! –ù–∞–≥–∞–¥—É—é –ø—Ä–æ —Ç–µ–±–µ üòä

–¢–∏ –≤–∂–µ –ø–æ–ø–æ–≤–Ω–∏–≤ —Ä–∞—Ö—É–Ω–æ–∫? 

–ü–µ—Ä—à–∏–π –¥–µ–ø–æ–∑–∏—Ç - –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏–π –∫—Ä–æ–∫! –ü–æ—á–Ω–∏ –∑ $10 —ñ –æ—Ç—Ä–∏–º–∞–π –±–æ–Ω—É—Å.

–ü–æ—Ç—Ä—ñ–±–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞? –ü–∏—à–∏! üí¨'
);

-- ============================================
-- –ü—Ä–∏–∫–ª–∞–¥ 2: –õ–∞–Ω—Ü—é–∂–æ–∫ –ø—ñ—Å–ª—è –ø–µ—Ä—à–æ–≥–æ –¥–µ–ø–æ–∑–∏—Ç—É (FTD)
-- ============================================

INSERT INTO message_chains (name, trigger_event, is_active)
VALUES ('–í—ñ—Ç–∞–Ω–Ω—è –ø—ñ—Å–ª—è –ø–µ—Ä—à–æ–≥–æ –¥–µ–ø–æ–∑–∏—Ç—É', 'ftd', true)
RETURNING id;

-- –ö—Ä–æ–∫ 1: –í—ñ—Ç–∞–Ω–Ω—è –∑ –ø–µ—Ä—à–∏–º –¥–µ–ø–æ–∑–∏—Ç–æ–º (–≤—ñ–¥—Ä–∞–∑—É)
INSERT INTO chain_steps (chain_id, step_order, delay_hours, message_type, message_text)
VALUES (
  2,  -- ID –ª–∞–Ω—Ü—é–∂–∫–∞ –¥–ª—è FTD
  1,
  0,
  'text',
  'üéâ –í—ñ—Ç–∞—é –∑ –ø–µ—Ä—à–∏–º –¥–µ–ø–æ–∑–∏—Ç–æ–º!

–¢–µ–ø–µ—Ä —Ç–∏ –º–æ–∂–µ—à –ø–æ—á–∞—Ç–∏ —Ç–æ—Ä–≥—É–≤–∞—Ç–∏ —ñ –∑–∞—Ä–æ–±–ª—è—Ç–∏!

üí° –ü–æ—Ä–∞–¥–∞: –ø–æ—á–Ω–∏ –∑ –Ω–µ–≤–µ–ª–∏–∫–∏—Ö —Å—É–º, —â–æ–± –Ω–∞–≤—á–∏—Ç–∏—Å—è —Ç–∞ –≤—ñ–¥—á—É—Ç–∏ —Ä–∏–Ω–æ–∫.

–£—Å–ø—ñ—Ö—ñ–≤! üöÄ'
);

-- –ö—Ä–æ–∫ 2: –ù–∞–≤—á–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç (—á–µ—Ä–µ–∑ 2 –≥–æ–¥–∏–Ω–∏)
INSERT INTO chain_steps (chain_id, step_order, delay_hours, message_type, message_text)
VALUES (
  2,
  2,
  2,
  'text',
  'üìö –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Ä–∞–¥–∏ –¥–ª—è –ø–æ—á–∞—Ç–∫—ñ–≤—Ü—ñ–≤:

‚úÖ –ù–µ —Ä–∏–∑–∏–∫—É–π –≤—Å—ñ–º–∞ –≥—Ä–æ—à–∏–º–∞ –≤—ñ–¥—Ä–∞–∑—É
‚úÖ –í–∏–≤—á–∞–π –≥—Ä–∞—Ñ—ñ–∫–∏ —Ç–∞ —Ç—Ä–µ–Ω–¥–∏
‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π —Å—Ç–æ–ø-–ª–æ—Å—Å
‚úÖ –ù–µ —Ç–æ—Ä–≥—É–π –Ω–∞ –µ–º–æ—Ü—ñ—è—Ö

–•–æ—á–µ—à –±—ñ–ª—å—à–µ –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤? –ü–∏—à–∏! üí¨'
);

-- ============================================
-- –ü—Ä–∏–∫–ª–∞–¥ 3: –õ–∞–Ω—Ü—é–∂–æ–∫ –∑ —É–º–æ–≤–æ—é (—Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –¥–µ–ø–æ–∑–∏—Ç > 50)
-- ============================================

INSERT INTO message_chains (name, trigger_event, is_active)
VALUES ('VIP –≤—ñ—Ç–∞–Ω–Ω—è –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –¥–µ–ø–æ–∑–∏—Ç—ñ–≤', 'ftd', true)
RETURNING id;

-- –¶–µ–π –ª–∞–Ω—Ü—é–∂–æ–∫ —Å–ø—Ä–∞—Ü—é—î —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –¥–µ–ø–æ–∑–∏—Ç >= 50 USD
INSERT INTO chain_steps (
  chain_id, 
  step_order, 
  delay_hours, 
  message_type, 
  message_text,
  conditions
)
VALUES (
  3,  -- ID –ª–∞–Ω—Ü—é–∂–∫–∞
  1,
  0,
  'text',
  '‚≠êÔ∏è VIP –≤—ñ—Ç–∞–Ω–Ω—è!

–î—è–∫—É—é –∑–∞ –¥–µ–ø–æ–∑–∏—Ç! –¢–∏ –æ–¥–∏–Ω –∑ –Ω–∞—à–∏—Ö –Ω–∞–π–∞–∫—Ç–∏–≤–Ω—ñ—à–∏—Ö —Ç—Ä–µ–π–¥–µ—Ä—ñ–≤!

üéÅ –°–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ–±–µ:
- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä
- –ï–∫—Å–∫–ª—é–∑–∏–≤–Ω—ñ —Å–∏–≥–Ω–∞–ª–∏
- –ü—ñ–¥–≤–∏—â–µ–Ω–∏–π –∫–µ—à–±–µ–∫

–ü–∏—Ç–∞–Ω–Ω—è? –ó–≤–µ—Ä—Ç–∞–π—Å—è –≤ –±—É–¥—å-—è–∫–∏–π —á–∞—Å! üíé',
  '{"min_deposit": 50}'  -- —É–º–æ–≤–∞: –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –¥–µ–ø–æ–∑–∏—Ç 50 USD
);

-- ============================================
-- –ü—Ä–∏–∫–ª–∞–¥ 4: –õ–∞–Ω—Ü—é–∂–æ–∫ –∑ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º
-- ============================================

INSERT INTO message_chains (name, trigger_event, is_active)
VALUES ('–ë–æ–Ω—É—Å–Ω–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è', 'registration', true)
RETURNING id;

INSERT INTO chain_steps (
  chain_id, 
  step_order, 
  delay_hours, 
  message_type, 
  message_text,
  image_url
)
VALUES (
  4,
  1,
  12,  -- —á–µ—Ä–µ–∑ 12 –≥–æ–¥–∏–Ω
  'text_with_image',
  'üéÅ –°–ü–ï–¶–Ü–ê–õ–¨–ù–ê –ü–†–û–ü–û–ó–ò–¶–Ü–Ø!

–ü–æ–ø–æ–≤–Ω–∏ —Ä–∞—Ö—É–Ω–æ–∫ —Å—å–æ–≥–æ–¥–Ω—ñ —ñ –æ—Ç—Ä–∏–º–∞–π +50% –¥–æ –¥–µ–ø–æ–∑–∏—Ç—É!

–ü–æ—Å–ø—ñ—à–∞–π, –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è –¥—ñ—î 24 –≥–æ–¥–∏–Ω–∏! ‚è∞',
  'https://images.unsplash.com/photo-1611974789855-9c2a0a7236a3?w=800'  -- –ø—Ä–∏–∫–ª–∞–¥ URL
);

-- ============================================
-- –ü–µ—Ä–µ–≥–ª—è–¥ —Å—Ç–≤–æ—Ä–µ–Ω–∏—Ö –ª–∞–Ω—Ü—é–∂–∫—ñ–≤
-- ============================================

SELECT 
  mc.id,
  mc.name,
  mc.trigger_event,
  mc.is_active,
  COUNT(cs.id) as steps_count
FROM message_chains mc
LEFT JOIN chain_steps cs ON mc.id = cs.chain_id
GROUP BY mc.id, mc.name, mc.trigger_event, mc.is_active
ORDER BY mc.id;

-- –ü–µ—Ä–µ–≥–ª—è–¥ –∫—Ä–æ–∫—ñ–≤ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–∞–Ω—Ü—é–∂–∫–∞
SELECT 
  id,
  step_order,
  delay_hours,
  message_type,
  LEFT(message_text, 50) as message_preview,
  conditions
FROM chain_steps
WHERE chain_id = 1  -- –∑–∞–º—ñ—Å—Ç—å 1 –ø—ñ–¥—Å—Ç–∞–≤ —Å–≤—ñ–π ID
ORDER BY step_order;
