# –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å –≤ Pocket Signals

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

–°–∏—Å—Ç–µ–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **–≥—ñ–±—Ä–∏–¥–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥** –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å:

1. **–§–∞–π–ª–∏** ‚Üí `/uploads/` –ø–∞–ø–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
2. **URL** ‚Üí PostgreSQL —Ç–∞–±–ª–∏—Ü—è `chain_steps`

## –ü–µ—Ä–µ–≤–∞–≥–∏

‚úÖ **–®–≤–∏–¥–∫—ñ—Å—Ç—å** - –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –º–∞–ª–µ–Ω—å–∫–æ—é —ñ —à–≤–∏–¥–∫–æ—é  
‚úÖ **–ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è** - –ª–µ–≥–∫–æ –ø–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ —Ñ–∞–π–ª–∏ –Ω–∞ CDN  
‚úÖ **–ë–µ–∫–∞–ø–∏** - –æ–∫—Ä–µ–º—ñ –±–µ–∫–∞–ø–∏ –¥–ª—è –±–∞–∑–∏ —ñ —Ñ–∞–π–ª—ñ–≤  
‚úÖ **Telegram API** - –ø—Ä–∞—Ü—é—î –∑ URL –Ω–∞–ø—Ä—è–º—É  

## –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

### 1. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è (Admin Panel)

```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–µ—Ä–µ—Ç—è–≥—É—î —Ñ–∞–π–ª
    ‚Üì
Frontend: uploadImage() ‚Üí FormData
    ‚Üì
Backend: POST /api/upload
    ‚Üì
Multer –∑–±–µ—Ä—ñ–≥–∞—î —Ñ–∞–π–ª: /uploads/image-123456789.png
    ‚Üì
–ü–æ–≤–µ—Ä—Ç–∞—î URL: http://localhost:3000/uploads/image-123456789.png
    ‚Üì
Frontend –∑–±–µ—Ä—ñ–≥–∞—î URL –≤ hidden input
    ‚Üì
–ü—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –ª–∞–Ω—Ü—é–∂–∫–∞ ‚Üí URL –π–¥–µ –≤ –±–∞–∑—É
```

### 2. –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö

```sql
INSERT INTO chain_steps (
    chain_id, 
    step_order, 
    message_type, 
    message_text, 
    image_url  -- ‚Üê –¢—É—Ç –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è URL!
) VALUES (
    1, 
    1, 
    'text_with_image', 
    '–í—ñ—Ç–∞—î–º–æ!',
    'http://localhost:3000/uploads/image-123456789.png'
);
```

### 3. –í—ñ–¥–ø—Ä–∞–≤–∫–∞ Telegram –±–æ—Ç–æ–º

```
Telegram Bot –æ—Ç—Ä–∏–º—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ —á–µ—Ä–≥–∏
    ‚Üì
–ß–∏—Ç–∞—î image_url –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
    ‚Üì
–ó–∞–≤–∞–Ω—Ç–∞–∂—É—î —Ñ–∞–π–ª –∑ URL —á–µ—Ä–µ–∑ axios
    ‚Üì
–í—ñ–¥–ø—Ä–∞–≤–ª—è—î –≤ Telegram —á–µ—Ä–µ–∑ Telethon
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫

```
pocket-signals/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ uploads/              ‚Üê –§–∞–π–ª–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —Ç—É—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ image-123.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ image-456.jpg
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ src/
‚îÇ       ‚îî‚îÄ‚îÄ controllers/
‚îÇ           ‚îî‚îÄ‚îÄ uploadController.js  ‚Üê –û–±—Ä–æ–±–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
‚îî‚îÄ‚îÄ admin-panel/
    ‚îî‚îÄ‚îÄ app.js                ‚Üê –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑ frontend
```

## –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### Backend (index.js)
```javascript
// –û–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤
app.use('/uploads', express.static(path.join(__dirname, '../../uploads')));
```

### Upload Controller
```javascript
const storage = multer.diskStorage({
  destination: path.join(__dirname, '../../../uploads'),
  filename: 'image-' + Date.now() + '-' + random + ext
});
```

## –õ—ñ–º—ñ—Ç–∏

- **–†–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É**: 5MB –º–∞–∫—Å–∏–º—É–º
- **–¢–∏–ø–∏ —Ñ–∞–π–ª—ñ–≤**: JPEG, PNG, GIF, WebP
- **–ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è**: –ù–µ–æ–±–º–µ–∂–µ–Ω–æ (–∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –¥–∏—Å–∫—É)

## –ë–µ–∑–ø–µ–∫–∞

‚úÖ –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–∏–ø—É —Ñ–∞–π–ª—É (—Ç—ñ–ª—å–∫–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è)  
‚úÖ –û–±–º–µ–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É (5MB)  
‚úÖ –£–Ω—ñ–∫–∞–ª—å–Ω—ñ —ñ–º–µ–Ω–∞ —Ñ–∞–π–ª—ñ–≤ (–∑–∞–ø–æ–±—ñ–≥–∞—î –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É)  
‚úÖ –°—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ —Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è  

## –ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –≤ –º–∞–π–±—É—Ç–Ω—å–æ–º—É

### –ú—ñ–≥—Ä–∞—Ü—ñ—è –Ω–∞ CDN (Cloudinary, AWS S3)

–Ø–∫—â–æ –ø—Ä–æ–µ–∫—Ç –≤–∏—Ä–æ—Å—Ç–µ, –º–æ–∂–Ω–∞ –ª–µ–≥–∫–æ –ø–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ —Ñ–∞–π–ª–∏ –Ω–∞ CDN:

1. –ó–∞–≤–∞–Ω—Ç–∞–∂—É–π —Ñ–∞–π–ª–∏ –æ–¥—Ä–∞–∑—É –Ω–∞ CDN –∑–∞–º—ñ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–∏—Å–∫—É
2. –ó–±–µ—Ä—ñ–≥–∞–π CDN URL –≤ `image_url`
3. Telegram bot –ø—Ä–æ–¥–æ–≤–∂—É—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –±–µ–∑ –∑–º—ñ–Ω!

```javascript
// –ü—Ä–∏–∫–ª–∞–¥ –∑ Cloudinary
const result = await cloudinary.uploader.upload(file);
const imageUrl = result.secure_url; // https://res.cloudinary.com/...
```

## Troubleshooting

### –§–∞–π–ª –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ (404)

**–ü—Ä–æ–±–ª–µ–º–∞**: Telegram bot –Ω–µ –º–æ–∂–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è  
**–†—ñ—à–µ–Ω–Ω—è**: –ü–µ—Ä–µ–≤—ñ—Ä —â–æ —Ñ–∞–π–ª —ñ—Å–Ω—É—î –≤ `/uploads/` —ñ URL –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä —á–∏ —ñ—Å–Ω—É—î —Ñ–∞–π–ª
ls -la backend/uploads/

# –ü–µ—Ä–µ–≤—ñ—Ä —á–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–π —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
# http://localhost:3000/uploads/image-123.png
```

### –§–∞–π–ª–∏ –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫—ñ

**–ü—Ä–æ–±–ª–µ–º–∞**: –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö —Ä–æ—Å—Ç–µ –∑–∞–Ω–∞–¥—Ç–æ —à–≤–∏–¥–∫–æ  
**–†—ñ—à–µ–Ω–Ω—è**: –ó–º–µ–Ω—à–∏ –ª—ñ–º—ñ—Ç —Ä–æ–∑–º—ñ—Ä—É –∞–±–æ –¥–æ–¥–∞–π compression

```javascript
// –í uploadController.js
limits: {
  fileSize: 2 * 1024 * 1024  // 2MB –∑–∞–º—ñ—Å—Ç—å 5MB
}
```

## API Endpoints

### POST /api/upload
–ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è

**Request:**
```
Content-Type: multipart/form-data
{
  image: <file>
}
```

**Response:**
```json
{
  "message": "–§–∞–π–ª —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ",
  "filename": "image-123456789.png",
  "url": "/uploads/image-123456789.png",
  "fullUrl": "http://localhost:3000/uploads/image-123456789.png"
}
```

### GET /api/images
–û—Ç—Ä–∏–º—É—î —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å

**Response:**
```json
{
  "images": [
    {
      "filename": "image-123.png",
      "url": "/uploads/image-123.png",
      "fullUrl": "http://localhost:3000/uploads/image-123.png",
      "size": 245678,
      "created": "2025-12-13T10:30:00.000Z"
    }
  ]
}
```

### DELETE /api/images/:filename
–í–∏–¥–∞–ª—è—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è

**Response:**
```json
{
  "message": "–§–∞–π–ª —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ"
}
```

---

**–ü—ñ–¥—Å—É–º–æ–∫**: –§–∞–π–ª–∏ –≤ `/uploads/`, URL –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö. –ü—Ä–æ—Å—Ç–æ, —à–≤–∏–¥–∫–æ, –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–æ! üöÄ
